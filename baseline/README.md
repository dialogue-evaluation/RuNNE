# RuBERT для извлечения именованных сущностей (Бейзлайн для соревнования RuNNE)

***

## Использование

Представлены следующие файлы: 
- `baseline.py` - Базовый скрипт, содержащий описание модели, а также её обучение и/или тестирование
- `iobes_flat_dataset.py` - скрипт, содержащий описание и обработку данных для модели
- `score.py` - скрипт как в `../scoring_program`
- `baseline.ipynb` - Ноутбук, альтернатива для обучения и/или тестирования модели. 

Есть два варианта запуска:
- Запустить `python baseline.py` в командной строке (настроив все нужные параметры в том же файлы)
- Запустить ноутбук `baseline.ipynb`. 

Перед запуском требуется:
1. Создать директорию `<IN_PATH>` - полное дерево по формату скрипта оценивания `score.py` (`ref`, `res`, а также файл со всеми сущностями `ners.txt`, см. `score.py`);
2. Скачать словарь - файл `vocab.txt` [отсюда](https://huggingface.co/DeepPavlov/rubert-base-cased/blob/main/vocab.txt);
3. Помимо самих данных, скачать оба файла `train.jsonl` и `dev.jsonl` из `../public_data` для автоматической проверки;
4. Создать директорию для сохранения логов и чекпойнтов для обучения. 

Для проверки после окончания обучения требуется получившийся после тестирования файл `<ВАШ IN_PATH>/res/dev.jsonl` переименовать в `test.jsonl` и загрузить в систему в виде zip-архива.

***

## Необходимые пакеты

- `PyTorch`
- `PyTorch Lightning`
- `HuggingFace Transformers`
- `HuggingFace Tokenizers`
- `NLTK (+punkt)`

*** 

#### Дополнительно

По всем вопросам писать в телеграм [@fulstock](https://t.me/fulstock) или на почту fulstocky@gmail.com.